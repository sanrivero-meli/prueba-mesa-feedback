<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulación de Crédito - Exploración 1: Wizard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border: 2px solid #333;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border: 2px solid #333;
        }

        .step {
            flex: 1;
            text-align: center;
            padding: 10px;
            border: 1px solid #333;
            background: white;
        }

        .step.active {
            background: #333;
            color: white;
        }

        .step.completed {
            background: #666;
            color: white;
        }

        .wizard-content {
            background: white;
            border: 2px solid #333;
            padding: 40px;
            min-height: 400px;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 16px;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #333;
            background: white;
            font-size: 16px;
        }

        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #333;
            background: white;
            font-size: 16px;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .btn {
            padding: 15px 30px;
            border: 2px solid #333;
            background: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }

        .btn:hover {
            background: #333;
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.primary {
            background: #333;
            color: white;
        }

        .btn.primary:hover {
            background: #555;
        }

        .hidden {
            display: none;
        }

        .summary-box {
            border: 2px solid #333;
            padding: 20px;
            margin-bottom: 20px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #ccc;
        }

        .summary-row:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 18px;
        }

        .installment-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .installment-table th,
        .installment-table td {
            border: 1px solid #333;
            padding: 10px;
            text-align: center;
        }

        .installment-table th {
            background: #333;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Simulación de Préstamo en Cuotas Fijas</h1>
            <p>Exploración 1: Proceso Paso a Paso (Wizard)</p>
        </div>

        <div class="progress-bar">
            <div class="step active" id="step1-indicator">
                <strong>1</strong><br>Monto
            </div>
            <div class="step" id="step2-indicator">
                <strong>2</strong><br>Plazo
            </div>
            <div class="step" id="step3-indicator">
                <strong>3</strong><br>Datos
            </div>
            <div class="step" id="step4-indicator">
                <strong>4</strong><br>Resumen
            </div>
        </div>

        <div class="wizard-content">
            <!-- Paso 1: Monto -->
            <div id="step1" class="step-content">
                <h2>¿Cuánto necesitas?</h2>
                <div class="form-group">
                    <label for="amount">Monto del préstamo</label>
                    <input type="number" id="amount" placeholder="$0" min="1000" max="500000" step="1000">
                </div>
                <div class="form-group">
                    <label>Rangos sugeridos:</label>
                    <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                        <button class="btn" onclick="setAmount(50000)">$50,000</button>
                        <button class="btn" onclick="setAmount(100000)">$100,000</button>
                        <button class="btn" onclick="setAmount(200000)">$200,000</button>
                        <button class="btn" onclick="setAmount(300000)">$300,000</button>
                    </div>
                </div>
            </div>

            <!-- Paso 2: Plazo -->
            <div id="step2" class="step-content hidden">
                <h2>¿En cuánto tiempo lo pagarás?</h2>
                <div class="form-group">
                    <label for="term">Plazo en meses</label>
                    <select id="term">
                        <option value="">Selecciona un plazo</option>
                        <option value="12">12 meses</option>
                        <option value="24">24 meses</option>
                        <option value="36">36 meses</option>
                        <option value="48">48 meses</option>
                        <option value="60">60 meses</option>
                    </select>
                </div>
                <div id="preview" style="margin-top: 30px; padding: 20px; border: 1px solid #333; background: #f9f9f9;">
                    <h3>Vista previa</h3>
                    <div id="preview-content">Selecciona un plazo para ver la estimación</div>
                </div>
            </div>

            <!-- Paso 3: Datos Personales -->
            <div id="step3" class="step-content hidden">
                <h2>Datos personales</h2>
                <div class="form-group">
                    <label for="name">Nombre completo</label>
                    <input type="text" id="name" placeholder="Tu nombre completo">
                </div>
                <div class="form-group">
                    <label for="email">Correo electrónico</label>
                    <input type="email" id="email" placeholder="tu@email.com">
                </div>
                <div class="form-group">
                    <label for="income">Ingresos mensuales</label>
                    <input type="number" id="income" placeholder="$0" min="0" step="1000">
                </div>
            </div>

            <!-- Paso 4: Resumen -->
            <div id="step4" class="step-content hidden">
                <h2>Resumen de tu simulación</h2>
                <div class="summary-box">
                    <div class="summary-row">
                        <span>Monto solicitado:</span>
                        <span id="summary-amount">$0</span>
                    </div>
                    <div class="summary-row">
                        <span>Plazo:</span>
                        <span id="summary-term">0 meses</span>
                    </div>
                    <div class="summary-row">
                        <span>Tasa de interés:</span>
                        <span id="summary-rate">2.5% mensual</span>
                    </div>
                    <div class="summary-row">
                        <span>Cuota mensual:</span>
                        <span id="summary-payment">$0</span>
                    </div>
                    <div class="summary-row">
                        <span>Total a pagar:</span>
                        <span id="summary-total">$0</span>
                    </div>
                </div>

                <h3>Tabla de amortización (primeras 6 cuotas)</h3>
                <table class="installment-table">
                    <thead>
                        <tr>
                            <th>Cuota</th>
                            <th>Capital</th>
                            <th>Interés</th>
                            <th>Cuota Total</th>
                            <th>Saldo</th>
                        </tr>
                    </thead>
                    <tbody id="amortization-table">
                    </tbody>
                </table>
            </div>

            <div class="button-group">
                <button class="btn" id="prevBtn" onclick="previousStep()" disabled>Anterior</button>
                <button class="btn primary" id="nextBtn" onclick="nextStep()">Siguiente</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;

        function showStep(step) {
            // Hide all steps
            for (let i = 1; i <= totalSteps; i++) {
                document.getElementById(`step${i}`).classList.add('hidden');
                document.getElementById(`step${i}-indicator`).classList.remove('active', 'completed');
            }

            // Show current step
            document.getElementById(`step${step}`).classList.remove('hidden');
            document.getElementById(`step${step}-indicator`).classList.add('active');

            // Mark previous steps as completed
            for (let i = 1; i < step; i++) {
                document.getElementById(`step${i}-indicator`).classList.add('completed');
            }

            // Update buttons
            document.getElementById('prevBtn').disabled = step === 1;
            document.getElementById('nextBtn').textContent = step === totalSteps ? 'Solicitar Préstamo' : 'Siguiente';
            document.getElementById('nextBtn').disabled = !isStepValid(step);
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
                if (currentStep === 4) {
                    generateSummary();
                }
            } else {
                alert('¡Simulación completada! En una implementación real, aquí se enviaría la solicitud.');
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function isStepValid(step) {
            switch (step) {
                case 1:
                    return document.getElementById('amount').value !== '';
                case 2:
                    return document.getElementById('term').value !== '';
                case 3:
                    return document.getElementById('name').value !== '' && 
                           document.getElementById('email').value !== '' && 
                           document.getElementById('income').value !== '';
                case 4:
                    return true;
                default:
                    return false;
            }
        }

        function setAmount(amount) {
            document.getElementById('amount').value = amount;
            document.getElementById('nextBtn').disabled = false;
        }

        function generateSummary() {
            const amount = parseFloat(document.getElementById('amount').value);
            const term = parseInt(document.getElementById('term').value);
            const rate = 0.025; // 2.5% mensual

            const monthlyPayment = calculateMonthlyPayment(amount, rate, term);
            const totalPayment = monthlyPayment * term;

            document.getElementById('summary-amount').textContent = `$${amount.toLocaleString()}`;
            document.getElementById('summary-term').textContent = `${term} meses`;
            document.getElementById('summary-payment').textContent = `$${Math.round(monthlyPayment).toLocaleString()}`;
            document.getElementById('summary-total').textContent = `$${Math.round(totalPayment).toLocaleString()}`;

            generateAmortizationTable(amount, rate, term, monthlyPayment);
        }

        function calculateMonthlyPayment(principal, rate, term) {
            return (principal * rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
        }

        function generateAmortizationTable(principal, rate, term, payment) {
            const tbody = document.getElementById('amortization-table');
            tbody.innerHTML = '';
            
            let balance = principal;
            
            for (let i = 1; i <= Math.min(term, 6); i++) {
                const interestPayment = balance * rate;
                const principalPayment = payment - interestPayment;
                balance -= principalPayment;

                const row = tbody.insertRow();
                row.insertCell(0).textContent = i;
                row.insertCell(1).textContent = `$${Math.round(principalPayment).toLocaleString()}`;
                row.insertCell(2).textContent = `$${Math.round(interestPayment).toLocaleString()}`;
                row.insertCell(3).textContent = `$${Math.round(payment).toLocaleString()}`;
                row.insertCell(4).textContent = `$${Math.round(balance).toLocaleString()}`;
            }
            
            if (term > 6) {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = '...';
                row.insertCell(1).textContent = '...';
                row.insertCell(2).textContent = '...';
                row.insertCell(3).textContent = '...';
                row.insertCell(4).textContent = '...';
            }
        }

        // Event listeners
        document.getElementById('amount').addEventListener('input', function() {
            document.getElementById('nextBtn').disabled = !isStepValid(1);
        });

        document.getElementById('term').addEventListener('change', function() {
            document.getElementById('nextBtn').disabled = !isStepValid(2);
            
            // Update preview
            const amount = parseFloat(document.getElementById('amount').value);
            const term = parseInt(this.value);
            if (amount && term) {
                const payment = calculateMonthlyPayment(amount, 0.025, term);
                document.getElementById('preview-content').innerHTML = `
                    <p><strong>Cuota mensual estimada: $${Math.round(payment).toLocaleString()}</strong></p>
                    <p>Total a pagar: $${Math.round(payment * term).toLocaleString()}</p>
                `;
            }
        });

        ['name', 'email', 'income'].forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                document.getElementById('nextBtn').disabled = !isStepValid(3);
            });
        });

        // Initialize
        showStep(1);
    </script>
</body>
</html>
